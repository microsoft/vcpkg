diff --git a/Xtransutil.c b/Xtransutil.c
index 2aa4686..57c6ce3 100644
--- a/Xtransutil.c
+++ b/Xtransutil.c
@@ -60,6 +60,10 @@ from The Open Group.
 #ifdef WIN32
 #include <X11/Xlibint.h>
 #include <X11/Xwinsock.h>
+#ifdef _MSC_VER
+# include <direct.h>
+# define S_ISDIR(m) (((m) & S_IFMT) == S_IFDIR)
+#endif
 #endif

 #if defined(IPv6) && !defined(AF_INET6)
