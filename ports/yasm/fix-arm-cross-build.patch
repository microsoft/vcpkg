diff --git a/CMakeLists.txt b/CMakeLists.txt
index 8df871cf..c47bc2a4 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,5 +1,5 @@
 PROJECT(yasm)
-CMAKE_MINIMUM_REQUIRED(VERSION 2.4)
+CMAKE_MINIMUM_REQUIRED(VERSION 3.8)
 if (COMMAND cmake_policy)
     cmake_policy(SET CMP0003 NEW)
 endif (COMMAND cmake_policy)
diff --git a/cmake/modules/YasmMacros.cmake b/cmake/modules/YasmMacros.cmake
index ab1be00e..5a6600ca 100644
--- a/cmake/modules/YasmMacros.cmake
+++ b/cmake/modules/YasmMacros.cmake
@@ -58,32 +58,37 @@ macro (YASM_ADD_MODULE _module_NAME)
 endmacro (YASM_ADD_MODULE)

 macro (YASM_GENPERF _in_NAME _out_NAME)
-    get_target_property(_tmp_GENPERF_EXE genperf LOCATION)
+    if (_tmp_GENPERF_EXE)
+        set(HAS_tmp_GENPERF_EXE 1)
+    endif()
     add_custom_command(
         OUTPUT ${_out_NAME}
-        COMMAND ${_tmp_GENPERF_EXE} ${_in_NAME} ${_out_NAME}
+        COMMAND $<IF:$<BOOL:${HAS_tmp_GENPERF_EXE}>,${_tmp_GENPERF_EXE},$<TARGET_FILE:genperf>> ${_tmp_GENPERF_EXE} ${_in_NAME} ${_out_NAME}
         DEPENDS ${_tmp_GENPERF_EXE}
         MAIN_DEPENDENCY ${_in_NAME}
         )
 endmacro (YASM_GENPERF)

 macro (YASM_RE2C _in_NAME _out_NAME)
-    get_target_property(_tmp_RE2C_EXE re2c LOCATION)
+    if (_tmp_RE2C_EXE)
+        set(HAS_tmp_RE2C_EXE 1)
+    endif()
     add_custom_command(
         OUTPUT ${_out_NAME}
-        COMMAND ${_tmp_RE2C_EXE} ${ARGN} -o ${_out_NAME} ${_in_NAME}
+        COMMAND $<IF:$<BOOL:${HAS_tmp_RE2C_EXE}>,${_tmp_RE2C_EXE},$<TARGET_FILE:re2c>> ${ARGN} -o ${_out_NAME} ${_in_NAME}
         DEPENDS ${_tmp_RE2C_EXE}
         MAIN_DEPENDENCY ${_in_NAME}
         )
 endmacro (YASM_RE2C)

 macro (YASM_GENMACRO _in_NAME _out_NAME _var_NAME)
-    get_target_property(_tmp_GENMACRO_EXE genmacro LOCATION)
+    if (_tmp_GENMACRO_EXE)
+        set(HAS_tmp_GENMACRO_EXE 1)
+    endif()
     add_custom_command(
         OUTPUT ${_out_NAME}
-        COMMAND ${_tmp_GENMACRO_EXE} ${_out_NAME} ${_var_NAME} ${_in_NAME}
+        COMMAND $<IF:$<BOOL:${HAS_tmp_GENMACRO_EXE}>,${_tmp_GENMACRO_EXE},$<TARGET_FILE:genmacro>> ${_out_NAME} ${_var_NAME} ${_in_NAME}
         DEPENDS ${_tmp_GENMACRO_EXE}
         MAIN_DEPENDENCY ${_in_NAME}
         )
 endmacro (YASM_GENMACRO)
-
diff --git a/modules/preprocs/nasm/CMakeLists.txt b/modules/preprocs/nasm/CMakeLists.txt
index e10a9dd1..b4b39558 100644
--- a/modules/preprocs/nasm/CMakeLists.txt
+++ b/modules/preprocs/nasm/CMakeLists.txt
@@ -1,9 +1,13 @@
+if (_tmp_GENVERSION_EXE)
+    set(HAS_tmp_GENVERSION_EXE 1)
+else()
 add_executable(genversion preprocs/nasm/genversion.c)
-get_target_property(_tmp_GENVERSION_EXE genversion LOCATION)
+install(TARGETS genversion RUNTIME DESTINATION bin)
+endif()
 add_custom_command(
     OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/version.mac
-    COMMAND ${_tmp_GENVERSION_EXE} ${CMAKE_CURRENT_BINARY_DIR}/version.mac
-    DEPENDS ${_tmp_GENVERSION_EXE}
+    COMMAND $<IF:$<BOOL:${HAS_tmp_GENVERSION_EXE}>,${_tmp_GENVERSION_EXE},$<TARGET_FILE:genversion>> ${CMAKE_CURRENT_BINARY_DIR}/version.mac
+    DEPENDS $<IF:$<BOOL:${HAS_tmp_GENVERSION_EXE}>,${_tmp_GENVERSION_EXE},$<TARGET_FILE:genversion>>
     )

 YASM_GENMACRO(
@@ -22,4 +26,3 @@ YASM_ADD_MODULE(preproc_nasm
     preprocs/nasm/nasmlib.c
     preprocs/nasm/nasm-eval.c
     )
-
diff --git a/tools/genmacro/CMakeLists.txt b/tools/genmacro/CMakeLists.txt
index 27ba5996..01684944 100644
--- a/tools/genmacro/CMakeLists.txt
+++ b/tools/genmacro/CMakeLists.txt
@@ -1,3 +1,7 @@
+if (NOT _tmp_GENMACRO_EXE)
 add_executable(genmacro
     genmacro.c
     )
+
+install(TARGETS genmacro RUNTIME DESTINATION bin)
+endif()
\ No newline at end of file
diff --git a/tools/genperf/CMakeLists.txt b/tools/genperf/CMakeLists.txt
index 6f50989e..87d19bc6 100644
--- a/tools/genperf/CMakeLists.txt
+++ b/tools/genperf/CMakeLists.txt
@@ -1,3 +1,4 @@
+if (NOT _tmp_GENPERF_EXE)
 add_executable(genperf
     genperf.c
     perfect.c
@@ -6,3 +7,6 @@ add_executable(genperf
     ../../libyasm/xstrdup.c
     )
 set_target_properties(genperf PROPERTIES COMPILE_FLAGS -DYASM_LIB_DECL=)
+
+install(TARGETS genperf RUNTIME DESTINATION bin)
+endif()
\ No newline at end of file
diff --git a/tools/re2c/CMakeLists.txt b/tools/re2c/CMakeLists.txt
index 7125d496..f2f1a40b 100644
--- a/tools/re2c/CMakeLists.txt
+++ b/tools/re2c/CMakeLists.txt
@@ -1,3 +1,4 @@
+if (NOT _tmp_RE2C_EXE)
 add_executable(re2c
     main.c
     code.c
@@ -9,3 +10,6 @@ add_executable(re2c
     substr.c
     translate.c
     )
+
+install(TARGETS re2c RUNTIME DESTINATION bin)
+endif()
\ No newline at end of file
