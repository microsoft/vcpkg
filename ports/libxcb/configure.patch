diff --git a/configure.ac b/configure.ac
index 4e6f028..12d66cb 100644
--- a/configure.ac
+++ b/configure.ac
@@ -23,6 +23,7 @@ AC_SYS_LARGEFILE
 # Initialize libtool
 LT_PREREQ([2.2])
 LT_INIT([win32-dll])
+AC_LIBTOOL_WIN32_DLL
 
 # Require xorg-macros minimum of 1.18 - Initial version
 m4_ifndef([XORG_MACROS_VERSION],
@@ -91,11 +92,11 @@ XCBPROTO_XCBPYTHONDIR=`$PKG_CONFIG --variable=pythondir xcb-proto`
 AC_MSG_RESULT($XCBPROTO_XCBPYTHONDIR)
 AC_SUBST(XCBPROTO_XCBPYTHONDIR)
 
-AC_SEARCH_LIBS(getaddrinfo, socket)
-AC_SEARCH_LIBS(connect, socket)
+AC_SEARCH_LIBS(getaddrinfo, [socket Ws2_32])
+AC_SEARCH_LIBS(connect, [socket Ws2_32])
 
 # Find support for sending a message from a socket
-AC_SEARCH_LIBS(sendmsg, socket, [have_sendmsg="yes"], [have_sendmsg="no"])
+AC_SEARCH_LIBS(sendmsg, [socket Ws2_32], [have_sendmsg="yes"], [have_sendmsg="no"])
 
 # XPG4v2/UNIX95 added msg_control - check to see if we need to define
 # _XOPEN_SOURCE to get it (such as on Solaris)
@@ -144,6 +145,10 @@ mingw*)
         have_win32="yes"
         lt_enable_auto_import="-Wl,--enable-auto-import"
         ;;
+msys*)
+        have_win32="yes"
+        lt_enable_auto_import="-Wl,--enable-auto-import"
+        ;;
 linux*)
         AC_DEFINE([HAVE_ABSTRACT_SOCKETS], 1, [Define if your platform supports abstract sockets])
         ;;
@@ -212,7 +217,7 @@ esac
 
 dnl Link with winsock for socket functions on MinGW
 case $host_os in
-        *mingw*)
+        *mingw*| *msys* )
                 AC_CHECK_LIB([ws2_32],[main])
                 ;;
         *)
@@ -227,7 +232,7 @@ XCB_EXTENSION(DRI2, yes)
 XCB_EXTENSION(DRI3, $have_sendmsg)
 XCB_EXTENSION(GE, no)
 XCB_EXTENSION(GLX, yes)
-XCB_EXTENSION(Present, yes)
+XCB_EXTENSION(Present, $have_sendmsg)
 XCB_EXTENSION(RandR, yes)
 XCB_EXTENSION(Record, yes)
 XCB_EXTENSION(Render, yes)
