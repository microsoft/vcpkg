diff --git a/CMakeLists.txt b/CMakeLists.txt
index b4b0c8210..5a6bdb24f 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -629,6 +629,11 @@ function(list_licenses OUTPUT MODULES)
     set(CONTENT)
     set(_MODULES ${MODULES} ${ARGN})
     foreach(module ${_MODULES})
+        list(FIND added_subdirectories "${subdirectory}" has_subdirectory)
+        if(${has_subdirectory} EQUAL -1)
+            continue()
+        endif()
+
         set(license_path "../../third_party/${module}/LICENSE")
         get_filename_component(fullname "${license_path}" ABSOLUTE)
         if(EXISTS ${fullname})
-- 
2.45.2

