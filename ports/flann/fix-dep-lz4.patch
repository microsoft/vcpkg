diff --git a/CMakeLists.txt b/CMakeLists.txt
index 5fd73ba..d196cf1 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -155,8 +155,8 @@ if (BUILD_CUDA_LIB)
     endif(CUDA_FOUND)
 endif(BUILD_CUDA_LIB)
 
-find_package(PkgConfig REQUIRED)
-pkg_check_modules(LZ4 REQUIRED liblz4)
+find_package(lz4 CONFIG REQUIRED)
+set(LZ4_LINK_LIBRARIES lz4::lz4)
 include_directories(${LZ4_INCLUDE_DIRS})
 
 #set the C/C++ include path to the "include" directory
@@ -169,7 +169,7 @@ if(CMAKE_C_COMPILER_ID MATCHES "MSVC" OR CMAKE_CXX_COMPILER_ID MATCHES "MSVC")
     # lots of warnings with cl.exe right now, use /W1
     add_definitions("/W1 -D_CRT_SECURE_NO_WARNINGS -D_SCL_SECURE_NO_WARNINGS /bigobj")
 else()
-    add_definitions( "-Wall -Wno-unknown-pragmas -Wno-unused-function" )
+    add_definitions( "-Wall -Wno-unknown-pragmas -Wno-unused-function -Wa,-mbig-obj" )
 endif()
 
 # install and export variables
diff --git a/cmake/Config.cmake.in b/cmake/Config.cmake.in
index 6b95a71..c50f432 100644
--- a/cmake/Config.cmake.in
+++ b/cmake/Config.cmake.in
@@ -1,5 +1,8 @@
 @PACKAGE_INIT@

+include(CMakeFindDependencyMacro)
+find_dependency(lz4 CONFIG)
+find_dependency(HDF5 CONFIG)
 include("${CMAKE_CURRENT_LIST_DIR}/@targets_export_name@.cmake")
 check_required_components("flann")
 
