diff --git a/caffe2/serialize/inline_container.h b/caffe2/serialize/inline_container.h
index e098bed..1fdc109 100644
--- a/caffe2/serialize/inline_container.h
+++ b/caffe2/serialize/inline_container.h
@@ -16,10 +16,8 @@
 #include "caffe2/serialize/read_adapter_interface.h"
 #include "caffe2/serialize/versions.h"
 
-extern "C" {
-typedef struct mz_zip_archive mz_zip_archive;
-}
+#include <miniz/miniz.h>
 
 // PyTorch containers are a special zip archive with the following layout
 // archive_name.zip contains:
 //    archive_name/
diff --git a/caffe2/serialize/inline_container.cc b/caffe2/serialize/inline_container.cc
index 4972c65..1ab7108 100644
--- a/caffe2/serialize/inline_container.cc
+++ b/caffe2/serialize/inline_container.cc
@@ -768,7 +768,7 @@ void PyTorchStreamWriter::writeRecord(
   uint32_t flags = compress ? MZ_BEST_COMPRESSION : 0;
   if (!compute_crc32_) {
 #if (!defined(FBCODE_CAFFE2))
-    flags |= MZ_ZIP_FLAG_DO_NOT_COMPUTE_CRC32;
+    // flags |= MZ_ZIP_FLAG_DO_NOT_COMPUTE_CRC32; // this flag doesn't exist in miniz_zip.h
 #endif
   }
   mz_zip_writer_add_mem_ex_v2(
