message(WARNING "find_package(unofficial-apr) is deprecated.\nUse find_package(apr) instead")
include(CMakeFindDependencyMacro)

# Try to find apr CONFIG (available on Windows)
# If not found, use pkg-config (Unix-like systems)
if(WIN32)
    find_package(apr CONFIG QUIET)
else()
    if(NOT TARGET apr::apr-1 AND NOT TARGET apr::libapr-1)
        find_package(PkgConfig QUIET)
        if(PKG_CONFIG_FOUND)
            pkg_check_modules(APR QUIET IMPORTED_TARGET apr-1)
            if(APR_FOUND)
                add_library(apr::apr-1 INTERFACE IMPORTED)
                target_link_libraries(apr::apr-1 INTERFACE PkgConfig::APR)
            endif()
        endif()
    endif()
endif()

if(TARGET apr::apr-1 AND NOT TARGET unofficial::apr::apr-1)
    add_library(unofficial::apr::apr-1 INTERFACE IMPORTED)
    target_link_libraries(unofficial::apr::apr-1 INTERFACE apr::apr-1)
elseif(TARGET apr::libapr-1 AND NOT TARGET unofficial::apr::libapr-1)
    add_library(unofficial::apr::libapr-1 INTERFACE IMPORTED)
    target_link_libraries(unofficial::apr::libapr-1 INTERFACE apr::libapr-1)
endif()

if(TARGET apr::aprapp-1 AND NOT TARGET unofficial::apr::aprapp-1)
    add_library(unofficial::apr::aprapp-1 INTERFACE IMPORTED)
    target_link_libraries(unofficial::apr::aprapp-1 INTERFACE apr::aprapp-1)
elseif(TARGET apr::libaprapp-1 AND NOT TARGET unofficial::apr::libaprapp-1)
    add_library(unofficial::apr::libaprapp-1 INTERFACE IMPORTED)
    target_link_libraries(unofficial::apr::libaprapp-1 INTERFACE apr::libaprapp-1)
endif()
