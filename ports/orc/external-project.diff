diff --git a/CMakeLists.txt b/CMakeLists.txt
index 341a4c3..1aaff3e 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -112,6 +112,13 @@ SET(CPACK_PACKAGE_CONTACT "Apache ORC <dev@orc.apache.org>")
 
 INCLUDE(CPack)
 INCLUDE(ExternalProject)
+function(ExternalProject_Add name)
+  z_vcpkg_function_arguments(args 1)
+  if(NOT "${name}" MATCHES "^orc-format")
+    message(FATAL_ERROR "Unexpected external project: ${name}")
+  endif()
+  _ExternalProject_Add(${name} "${args}")
+endfunction()
 
 if (BUILD_POSITION_INDEPENDENT_LIB)
   set(CMAKE_POSITION_INDEPENDENT_CODE ON)
diff --git a/cmake_modules/ThirdpartyToolchain.cmake b/cmake_modules/ThirdpartyToolchain.cmake
index 851cdc4..a23115e 100644
--- a/cmake_modules/ThirdpartyToolchain.cmake
+++ b/cmake_modules/ThirdpartyToolchain.cmake
@@ -397,7 +397,7 @@ add_library (orc::lz4 ALIAS orc_lz4)
 # ----------------------------------------------------------------------
 # IANA - Time Zone Database
 
-if (WIN32)
+if (WIN32 AND BUILD_CPP_TESTS)
   SET(CURRENT_TZDATA_FILE "")
   SET(CURRENT_TZDATA_SHA512 "")
   File(DOWNLOAD "https://ftp.osuosl.org/pub/cygwin/noarch/release/tzdata/sha512.sum" ${CMAKE_CURRENT_BINARY_DIR}/sha512.sum)
