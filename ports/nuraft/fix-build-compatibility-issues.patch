diff --git a/CMakeLists.txt b/CMakeLists.txt
index 0e5ac72..59a0032 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -170,7 +170,12 @@ else()
     # === Other shared libraries ===
     if(NOT WIN32)
         set(LIBDL dl)
-        set(LIBZ z)
+        find_package(ZLIB QUIET)
+        if(ZLIB_FOUND)
+            set(LIBZ ZLIB::ZLIB)
+        else()
+            set(LIBZ z)
+        endif()
     endif()
 endif(WITH_CONAN)
 
@@ -208,7 +213,7 @@ if(NOT WIN32)
     endif()
 
 else()
-    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /wd5045 /wd4571 /wd4774 /wd4820 /wd5039 /wd4626 /wd4625 /wd5026 /wd5027 /wd4623 /wd4996 /wd4530 /wd4267 /wd4244 /W3")
+    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /wd5045 /wd4571 /wd4774 /wd4820 /wd5039 /wd4626 /wd4625 /wd5026 /wd5027 /wd4623 /wd4996 /wd4530 /wd4267 /wd4244 /W3 /permissive-")
     message(STATUS "---- WIN32 ----")
 
     if(USE_PTHREAD_EXIT)
@@ -335,10 +340,6 @@ add_library(static_lib ${STATIC_LIB_SRC})
 add_library(NuRaft::static_lib ALIAS static_lib)
 set_target_properties(static_lib PROPERTIES OUTPUT_NAME ${LIBRARY_NAME} CLEAN_DIRECT_OUTPUT 1)
 
-add_library(shared_lib SHARED ${STATIC_LIB_SRC})
-add_library(NuRaft::shared_lib ALIAS shared_lib)
-set_target_properties(shared_lib PROPERTIES OUTPUT_NAME ${LIBRARY_NAME} CLEAN_DIRECT_OUTPUT 1)
-
 # Include directories are necessary for dependents to use the targets.
 target_include_directories(static_lib
     PUBLIC
@@ -346,17 +347,25 @@ target_include_directories(static_lib
     $<INSTALL_INTERFACE:${CMAKE_INSTALL_PREFIX}/include>
 )
 
-target_include_directories(shared_lib
-    PUBLIC
-    $<BUILD_INTERFACE:${PROJECT_SOURCE_DIR}/include>
-    $<INSTALL_INTERFACE:${CMAKE_INSTALL_PREFIX}/include>
-)
-
 # if (APPLE)
 # There is no harm in adding libraries; this is required when building with Conan
-target_link_libraries(shared_lib ${LIBRARIES})
 target_link_libraries(static_lib ${LIBRARIES})
 
+if(NOT WIN32)
+    set(TARGET_LIST "shared_lib;static_lib")
+    add_library(shared_lib SHARED ${STATIC_LIB_SRC})
+    add_library(NuRaft::shared_lib ALIAS shared_lib)
+    set_target_properties(shared_lib PROPERTIES OUTPUT_NAME ${LIBRARY_NAME} CLEAN_DIRECT_OUTPUT 1)
+    target_include_directories(shared_lib
+        PUBLIC
+        $<BUILD_INTERFACE:${PROJECT_SOURCE_DIR}/include>
+        $<INSTALL_INTERFACE:${CMAKE_INSTALL_PREFIX}/include>
+    )
+    target_link_libraries(shared_lib ${LIBRARIES})
+else()
+    set(TARGET_LIST "static_lib")
+endif()
+
 # endif ()
 if(WIN32)
     set(LIBRARY_OUTPUT_NAME "${LIBRARY_NAME}.lib")
@@ -404,7 +413,7 @@ if(CODE_COVERAGE GREATER 0)
 endif()
 
 # === Install Targets ===
-install(TARGETS shared_lib static_lib
+install(TARGETS ${TARGET_LIST}
     EXPORT nuraft-targets
     LIBRARY DESTINATION lib
     ARCHIVE DESTINATION lib
