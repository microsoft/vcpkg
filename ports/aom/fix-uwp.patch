diff --git a/aom_util/aom_pthread.h b/aom_util/aom_pthread.h
index 89c0c96..e510c7a 100644
--- a/aom_util/aom_pthread.h
+++ b/aom_util/aom_pthread.h
@@ -32,6 +32,7 @@ extern "C" {
 #include <process.h>  // NOLINT
 #include <stddef.h>   // NOLINT
 #include <windows.h>  // NOLINT
+#include <threadpoolapiset.h>
 typedef HANDLE pthread_t;
 typedef int pthread_attr_t;
 typedef CRITICAL_SECTION pthread_mutex_t;
@@ -92,10 +93,10 @@ static inline int pthread_create(pthread_t *const thread,
                                  void *arg) {
   (void)attr;
 #ifdef USE_CREATE_THREAD
-  *thread = CreateThread(NULL,          /* lpThreadAttributes */
-                         0,             /* dwStackSize */
-                         start, arg, 0, /* dwStackSize */
-                         NULL);         /* lpThreadId */
+  PTP_WORK work = CreateThreadpoolWork((PTP_WORK_CALLBACK)start, arg, NULL);
+  if (work == NULL) return 1;
+  SubmitThreadpoolWork(work);
+  *thread = (pthread_t)work; 
 #else
   *thread = (pthread_t)_beginthreadex(NULL,          /* void *security */
                                       0,             /* unsigned stack_size */
