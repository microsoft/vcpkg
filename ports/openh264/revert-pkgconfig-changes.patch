diff --git a/meson.build b/meson.build
index 5dbefa43..50b48232 100644
--- a/meson.build
+++ b/meson.build
@@ -197,18 +197,38 @@ libopenh264 = library('openh264',
   link_whole: [libcommon, libprocessing, libencoder, libdecoder],
   install: true,
   soversion: major_version,
-  version: meson.project_version(),
   vs_module_defs: 'openh264.def',
   dependencies: deps)
 
+pkg_install_dir = '@0@/pkgconfig'.format(get_option('libdir'))
+
+foreach t : ['', '-static']
+  pkgconf = configuration_data()
+  pkgconf.set('prefix', join_paths(get_option('prefix')))
+  pkgconf.set('libdir', '${prefix}/@0@'.format(get_option('libdir')))
+  pkgconf.set('VERSION', meson.project_version())
+  pkglibs = cpp_lib
+  if libm_dep.found()
+    pkglibs += ' -lm'
+  endif
+  if t == '-static'
+    pkgconf.set('LIBS', pkglibs)
+    pkgconf.set('LIBS_PRIVATE', '')
+  else
+    pkgconf.set('LIBS', '')
+    pkgconf.set('LIBS_PRIVATE', pkglibs)
+  endif
+
+  configure_file(
+    input: 'openh264.pc.in',
+    output: 'openh264@0@.pc'.format(t),
+    install: t == '-static' ? false : true,
+    install_dir: t == '-static' ? '' : pkg_install_dir,
+    configuration: pkgconf)
+endforeach
+
 openh264_dep = declare_dependency(
   link_with: libopenh264,
   include_directories: include_directories('codec/api'),
   dependencies: deps)
 
-pkg = import('pkgconfig')
-pkg.generate(libopenh264,
-  description: 'OpenH264 is a codec library which supports H.264 encoding ' +
-               'and decoding. It is suitable for use in real time ' +
-               'applications such as WebRTC.',
-)
