diff --git a/CMakeLists.txt b/CMakeLists.txt
index 9e0ad1e..cc9781e 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -38,9 +38,20 @@ include(CheckIncludeFile)
 check_include_file("unistd.h" HAVE_UNISTD_H)
 
 include(CheckLibraryExists)
-check_library_exists(crc32c crc32c_value "" HAVE_CRC32C)
-check_library_exists(snappy snappy_compress "" HAVE_SNAPPY)
-check_library_exists(tcmalloc malloc "" HAVE_TCMALLOC)
+if (WITH_CRC32C)
+    find_package(Crc32c CONFIG REQUIRED)
+    set(HAVE_CRC32C 1)
+endif()
+if (WITH_SNAPPY)
+    find_package(Snappy CONFIG REQUIRED)
+    set(HAVE_SNAPPY 1)
+endif()
+if (WITH_TCMALLOC)
+    check_library_exists(tcmalloc malloc "" HAVE_TCMALLOC)
+    if (NOT HAVE_TCMALLOC)
+      message(FATAL_ERROR "tcmalloc not found but marked as required")
+    endif()
+endif()
 
 include(CheckCXXSymbolExists)
 # Using check_cxx_symbol_exists() instead of check_c_symbol_exists() because
