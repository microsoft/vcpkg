diff --git a/CMakeLists.txt b/CMakeLists.txt
index a77d982..fa58df3 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -188,6 +188,8 @@ set(check_cxx_source_linkage_flags)
 if(NOT CMAKE_CXX_STANDARD)
   if(MSVC)
     set(check_cxx_source_linkage_flags /std:c++17)
+    # for checking __cplusplus
+    set(CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS} /Zc:__cplusplus")
   else()
     set(check_cxx_source_linkage_flags -std=c++17)
   endif()
