diff --git a/easy_profiler_core/event_trace_win.cpp b/easy_profiler_core/event_trace_win.cpp
index bdb4d7b..01ce320 100644
--- a/easy_profiler_core/event_trace_win.cpp
+++ b/easy_profiler_core/event_trace_win.cpp
@@ -56,7 +56,7 @@
 *                   : limitations under the License.
 ************************************************************************/
 
-#ifdef _WIN32
+#if defined(_WIN32) && !defined(WINAPI_FAMILY) || (WINAPI_FAMILY == WINAPI_FAMILY_DESKTOP_APP)
 #include <memory.h>
 #include <chrono>
 #include <unordered_map>
